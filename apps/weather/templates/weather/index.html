{% extends 'base.html' %}
{% load static %}

{% block title %}Weather - My Portfolio{% endblock %}

{% block extra_css %}
<style>
    .weather-icon {
        width: 100px;
        height: 100px;
    }
    .forecast-icon {
        width: 60px;
        height: 60px;
    }
    .weather-card {
        background: linear-gradient(135deg, #1ce777 0%, #3b0670 100%);
        color: white;
    }
    .city-card:hover {
        transform: translateY(-5px);
        transition: transform 0.3s ease;
    }
    .weather-detail-icon {
        font-size: 1.5rem;
        opacity: 0.8;
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="bg-dark text-white py-5">
    <div class="container">
        <h1 class="display-4 mb-3">
            <i class="bi bi-cloud-sun"></i> Weather Forecast
        </h1>
        <p class="lead">Get current weather and 5-day forecasts for any city worldwide</p>
    </div>
</section>

<!-- Search Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h4 class="text-center mb-4 text-white" style="background: linear-gradient(135deg, #094126 0%, #470964 100%);">Search Weather by City</h4>
                        <form method="get" action="{% url 'weather:index' %}">
                            <div class="input-group input-group-lg">
                                <span class="input-group-text">
                                    <i class="bi bi-search"></i>
                                </span>
                                <input type="text" 
                                       name="city" 
                                       class="form-control" 
                                       placeholder="Enter city name (e.g., Nairobi, London, New York)"
                                       value="{{ city }}"
                                       required>
                                <button class="btn btn-primary" type="submit">
                                    <i class="bi bi-cloud-sun"></i> Get Weather
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Current Weather Section -->
{% if weather_data %}
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <!-- Main Weather Card -->
                <div class="card shadow-lg mb-4 weather-card">
                    <div class="card-body p-5">
                        <div class="row align-items-center">
                            <div class="col-md-4 text-center">
                                <img src="https://openweathermap.org/img/wn/{{ weather_data.icon }}@4x.png" 
                                     alt="{{ weather_data.description }}"
                                     class="weather-icon">
                                <h3 class="mt-3">{{ weather_data.description }}</h3>
                            </div>
                            <div class="col-md-8">
                                <h2 class="display-4 mb-0">
                                    {{ weather_data.temperature }}°C
                                </h2>
                                <h3 class="mb-3">
                                    <i class="bi bi-geo-alt"></i>
                                    {{ weather_data.city }}, {{ weather_data.country }}
                                </h3>
                                <p class="h5 mb-0">
                                    Feels like {{ weather_data.feels_like }}°C
                                </p>
                                <p class="opacity-75">
                                    H: {{ weather_data.temp_max }}°C  L: {{ weather_data.temp_min }}°C
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Weather Details Grid -->
                <div class="row g-3 mb-4">
                    <div class="col-md-3 col-sm-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-droplet-fill text-primary weather-detail-icon"></i>
                                <h6 class="mt-2 text-muted">Humidity</h6>
                                <h4>{{ weather_data.humidity }}%</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-wind text-info weather-detail-icon"></i>
                                <h6 class="mt-2 text-muted">Wind Speed</h6>
                                <h4>{{ weather_data.wind_speed }} km/h</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-speedometer text-warning weather-detail-icon"></i>
                                <h6 class="mt-2 text-muted">Pressure</h6>
                                <h4>{{ weather_data.pressure }} hPa</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="card shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-eye-fill text-secondary weather-detail-icon"></i>
                                <h6 class="mt-2 text-muted">Visibility</h6>
                                <h4>{{ weather_data.visibility }} km</h4>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sun Times -->
                <div class="row g-3 mb-4">
                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body text-center">
                                <i class="bi bi-sunrise-fill text-warning" style="font-size: 2rem;"></i>
                                <h6 class="mt-2 text-muted">Sunrise</h6>
                                <h4>{{ weather_data.sunrise }}</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body text-center">
                                <i class="bi bi-sunset-fill text-danger" style="font-size: 2rem;"></i>
                                <h6 class="mt-2 text-muted">Sunset</h6>
                                <h4>{{ weather_data.sunset }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 5-Day Forecast -->
{% if forecast_data %}
<section class="py-5 bg-light text-white" style="background: linear-gradient(135deg, #094126 0%, #470964 100%);">
    <div class="container">
        <h2 class="text-center mb-5">
            <i class="bi bi-calendar-week"></i> 5-Day Forecast
        </h2>
        <div class="row g-3">
            {% for forecast in forecast_data %}
            <div class="col-md-2-4 col-sm-6">
                <div class="card shadow-sm text-center h-100 hover-lift">
                    <div class="card-body">
                        <h6 class="card-title">{{ forecast.date }}</h6>
                        <img src="https://openweathermap.org/img/wn/{{ forecast.icon }}@2x.png" 
                             alt="{{ forecast.description }}"
                             class="forecast-icon my-2">
                        <h4 class="mb-0">{{ forecast.temperature }}°C</h4>
                        <small class="text-muted">
                            H: {{ forecast.temp_max }}° L: {{ forecast.temp_min }}°
                        </small>
                        <p class="small text-muted mt-2 mb-1">{{ forecast.description }}</p>
                        <div class="small text-muted">
                            <i class="bi bi-droplet"></i> {{ forecast.humidity }}%
                            <i class="bi bi-wind ms-2"></i> {{ forecast.wind_speed }} km/h
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}
{% endif %}

<!-- Popular Cities Section -->
<section class="py-5 {% if not weather_data %}bg-light{% endif %}">
    <div class="container">
        <h2 class="text-center mb-5 text-white" style="background: linear-gradient(135deg, #094126 0%, #470964 100%);">
            <i class="bi bi-globe"></i> Popular Cities
        </h2>
        <div class="row g-3">
            {% for popular_city in default_cities %}
            <div class="col-md-3 col-sm-6">
                <a href="{% url 'weather:quick_weather' popular_city %}" 
                   class="text-decoration-none">
                    <div class="card shadow-sm city-card h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-building text-primary" style="font-size: 2rem;"></i>
                            <h5 class="mt-2 mb-0">{{ popular_city }}</h5>
                            <small class="text-white" style="background: linear-gradient(135deg, #094126 0%, #470964 100%);">Click to view weather</small>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- How to Use Section -->
{% if not weather_data %}
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4 text-white text-center" style="background: linear-gradient(135deg, #094126 0%, #470964 100%);">
                            <i class="bi bi-info-circle text-white"></i> How to Use
                        </h4>
                        <ol>
                            <li class="mb-2">
                                <strong>Search:</strong> Enter any city name in the search box above
                            </li>
                            <li class="mb-2">
                                <strong>Quick Access:</strong> Click on any popular city card for instant weather
                            </li>
                            <li class="mb-2">
                                <strong>Details:</strong> View current conditions, temperature, humidity, wind speed, and more
                            </li>
                            <li class="mb-2">
                                <strong>Forecast:</strong> Check the 5-day weather forecast for planning ahead
                            </li>
                            <li>
                                <strong>Metrics:</strong> All temperatures in Celsius, wind speed in km/h
                            </li>
                        </ol>
                        
                        <div class="alert alert-info mt-4">
                            <i class="bi bi-lightbulb"></i>
                            <strong>Tip:</strong> Weather data is cached for 30 minutes to improve performance. 
                            Forecast data is cached for 1 hour.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}